/*!*********************************************************************************************************************
@file Spi_Slave.h                                                                
@brief Header file for Spi_Slave
**********************************************************************************************************************/

#ifndef __SPI_SLAVE_H
#define __SPI_SLAVE_H

/**********************************************************************************************************************
Type Definitions
**********************************************************************************************************************/
#define RX_READY ( (AT91C_BASE_US2->US_IMR & AT91C_US_RXRDY) && \
                   (AT91C_BASE_US2->US_CSR & AT91C_US_RXRDY)       )

#define TX_READY ( (AT91C_BASE_US2->US_IMR & AT91C_US_TXRDY) && \
                   (AT91C_BASE_US2->US_CSR & AT91C_US_TXRDY)       )

#define SET_MRDY() ( AT91C_BASE_PIOB->PIO_SODR = PB_23_ANT_MRDY );
#define CLR_MRDY() ( AT91C_BASE_PIOB->PIO_CODR = PB_23_ANT_MRDY );
#define SET_SRDY() ( AT91C_BASE_PIOB->PIO_SODR = PB_24_ANT_SRDY );
#define CLR_SRDY() ( AT91C_BASE_PIOB->PIO_CODR = PB_24_ANT_SRDY );


/**********************************************************************************************************************
Function Declarations
**********************************************************************************************************************/

/*------------------------------------------------------------------------------------------------------------------*/
/*! @publicsection */                                                                                            
/*--------------------------------------------------------------------------------------------------------------------*/
u8 SpiGetRHR(void);

/*------------------------------------------------------------------------------------------------------------------*/
/*! @protectedsection */                                                                                            
/*--------------------------------------------------------------------------------------------------------------------*/
void SpiSlaveInitialize(void);
void SpiSlaveRunActiveState(void);


/*------------------------------------------------------------------------------------------------------------------*/
/*! @privatesection */                                                                                            
/*--------------------------------------------------------------------------------------------------------------------*/


/***********************************************************************************************************************
State Machine Declarations
***********************************************************************************************************************/
static void SpiSlaveSM_Idle(void);    
static void SpiSlaveSM_Error(void);         
static void SpiSlaveSM_RX_CB(void);
static void SpiSlaveSM_Sync(void);


/**********************************************************************************************************************
Constants / Definitions
**********************************************************************************************************************/


#endif /* __SPI_SLAVE_H */
/*--------------------------------------------------------------------------------------------------------------------*/
/* End of File                                                                                                        */
/*--------------------------------------------------------------------------------------------------------------------*/
